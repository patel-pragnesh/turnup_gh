function S4(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function guid(){return S4()+S4()+"-"+S4()+"-"+S4()+"-"+S4()+"-"+S4()+S4()+S4()}function Sync(i,t,e){var o=t.config.adapter.collection_name?t.config.adapter.collection_name:"default",s=new RegExp("^("+o+")\\-(.+)$"),l=null;if("read"===i)if(e.parse){var r=[];_.each(TAP.listProperties(),function(i){var t=i.match(s);null!==t&&r.push(TAP.getObject(i))}),l=r}else{var a=TAP.getObject(o+"-"+t.id);t.set(a),l=t.toJSON()}else"create"===i||"update"===i?(t.id||(t.id=guid(),t.set(t.idAttribute,t.id)),TAP.setObject(o+"-"+t.id,t.toJSON()||{}),l=t.toJSON()):"delete"===i&&(TAP.removeProperty(o+"-"+t.id),t.clear(),l=t.toJSON());l?(_.isFunction(e.success)&&e.success(l),"read"===i&&t.trigger("fetch")):_.isFunction(e.error)&&e.error(l)}var Alloy=require("alloy"),_=require("alloy/underscore")._,TAP=Ti.App.Properties;module.exports.sync=Sync,module.exports.beforeModelCreate=function(i){return i=i||{},i.columns=i.columns||{},i.defaults=i.defaults||{},("undefined"==typeof i.columns.id||null===i.columns.id)&&(i.columns.id="String"),i};