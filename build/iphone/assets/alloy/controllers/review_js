function __processArg(e,i){var t=null;return e&&(t=e[i]||null,delete e[i]),t}function Controller(){require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="review",arguments[0]&&(__processArg(arguments[0],"__parentSymbol"),__processArg(arguments[0],"$model"),__processArg(arguments[0],"__itemTemplate"));var e=this,i={},t={};e.__views.review=Ti.UI.createWindow({backgroundColor:Alloy.CFG.Colors.BackgroundColor,opacity:1,width:Ti.UI.FILL,height:Ti.UI.FILL,layout:"vertical",navBarHidden:!0,id:"review"}),e.__views.review&&e.addTopLevelView(e.__views.review),e.__views.__alloyId24=Ti.UI.createView({height:Ti.UI.SIZE,width:Ti.UI.FILL,backgroundColor:Alloy.CFG.Colors.MainColor,top:0,id:"__alloyId24"}),e.__views.review.add(e.__views.__alloyId24),e.__views.AppWrapper=Ti.UI.createView({height:Ti.UI.SIZE,id:"AppWrapper"}),e.__views.__alloyId24.add(e.__views.AppWrapper),e.__views.mainTitle=Ti.UI.createLabel({font:{fontSize:20,fontFamily:"Jengle Jungallery"},height:44.4,color:"#FFF",left:"25",id:"mainTitle",text:"Reserve your spot now!"}),e.__views.AppWrapper.add(e.__views.mainTitle),h?e.__views.mainTitle.addEventListener("click",h):t["$.__views.mainTitle!click!closeWindow"]=!0,e.__views.imgBack=Ti.UI.createImageView({left:5,width:20,height:20,right:5,id:"imgBack"}),e.__views.AppWrapper.add(e.__views.imgBack),h?e.__views.imgBack.addEventListener("click",h):t["$.__views.imgBack!click!closeWindow"]=!0,e.__views.__alloyId25=Ti.UI.createScrollView({height:Ti.UI.FILL,width:Ti.UI.FILL,layout:"vertical",id:"__alloyId25"}),e.__views.review.add(e.__views.__alloyId25),e.__views.infoEdit=Ti.UI.createView({layout:"vertical",width:Ti.UI.FILL,height:Ti.UI.SIZE,left:15,right:15,top:5,id:"infoEdit"}),e.__views.__alloyId25.add(e.__views.infoEdit),e.__views.__alloyId26=Ti.UI.createView({layout:"horizontal",width:Ti.UI.SIZE,height:Ti.UI.SIZE,top:5,left:"0",id:"__alloyId26"}),e.__views.infoEdit.add(e.__views.__alloyId26),e.__views.imgMessageReview=Ti.UI.createImageView({top:15,width:20,height:20,left:5,right:5,id:"imgMessageReview"}),e.__views.__alloyId26.add(e.__views.imgMessageReview),e.__views.lblReviewMessage=Ti.UI.createLabel({font:{fontSize:19,fontFamily:"BodoniFLF",fontWeight:"bold"},height:Ti.UI.SIZE,textAlign:"left",text:"Your Reservation Message",top:"11",color:"#454545",id:"lblReviewMessage"}),e.__views.__alloyId26.add(e.__views.lblReviewMessage),e.__views.txtReviewMessage=Ti.UI.createTextArea({top:5,width:"98%",left:"1%",right:"1%",borderWidth:1,borderColor:Alloy.CFG.Colors.MainColor,backgroundColor:"#EEE",color:"#222",font:{fontFamily:"BodoniFLF"},borderRadius:3,height:120,paddingLeft:5,paddingRight:5,id:"txtReviewMessage",hintText:"Review Message"}),e.__views.infoEdit.add(e.__views.txtReviewMessage),e.__views.__alloyId27=Ti.UI.createView({layout:"horizontal",width:Ti.UI.SIZE,height:Ti.UI.SIZE,top:5,left:"0",id:"__alloyId27"}),e.__views.infoEdit.add(e.__views.__alloyId27),e.__views.imgUserNameReview=Ti.UI.createImageView({top:15,width:20,height:20,left:5,right:5,id:"imgUserNameReview"}),e.__views.__alloyId27.add(e.__views.imgUserNameReview),e.__views.lblName=Ti.UI.createLabel({font:{fontSize:19,fontFamily:"BodoniFLF",fontWeight:"bold"},height:Ti.UI.SIZE,textAlign:"left",top:"13",id:"lblName",color:"#454545"}),e.__views.__alloyId27.add(e.__views.lblName),e.__views.__alloyId28=Ti.UI.createView({layout:"horizontal",width:Ti.UI.SIZE,height:Ti.UI.SIZE,top:5,left:"0",id:"__alloyId28"}),e.__views.infoEdit.add(e.__views.__alloyId28),e.__views.imgEmailReview=Ti.UI.createImageView({top:15,width:15,height:15,left:5,right:5,id:"imgEmailReview"}),e.__views.__alloyId28.add(e.__views.imgEmailReview),e.__views.lblEmail=Ti.UI.createLabel({font:{fontSize:19,fontFamily:"BodoniFLF",fontWeight:"bold"},height:Ti.UI.SIZE,textAlign:"left",top:"9",id:"lblEmail",color:"#454545"}),e.__views.__alloyId28.add(e.__views.lblEmail),e.__views.btnSubmit=Ti.UI.createButton({font:{fontSize:18,fontFamily:"BodoniFLF"},height:33.3,top:20,bottom:10,width:"98%",left:"1%",right:"1%",backgroundColor:Alloy.CFG.Colors.MainColor,backgroundSelectedColor:Alloy.CFG.Colors.MainColor_Dark,borderColor:Alloy.CFG.Colors.MainPressedColor,color:Alloy.CFG.Colors.TextColor,backgroundImage:"null",selectedColor:"#AAA",id:"btnSubmit",title:" Submit Reservation "}),e.__views.infoEdit.add(e.__views.btnSubmit),u?e.__views.btnSubmit.addEventListener("click",u):t["$.__views.btnSubmit!click!doReviewSubmit"]=!0,i.destroy=function(){},_.extend(e,e.__views);var o=arguments[0]||{},r=require("loadingWindow"),a=require("platformSupport"),l=require("animation"),n=require("loader"),s=require("validationRules"),d=require("psdialog"),c=Alloy.Collections.users,g=require("icomoonlib");a.isiOS7Plus()&&(e.AppWrapper.top=20);var m=function(){var i=Ti.App.Properties.getString("userId");c.fetch();var t=c.get(i);e.lblName.text=t.get("username"),e.lblEmail.text=t.get("email"),p(),y(),r.endLoading()},h=function(){l.out(e.review)},u=function(){if(w())if(1==Titanium.Network.online){r.startLoading();var i={review:e.txtReviewMessage.value,appuser_id:Ti.App.Properties.getString("userId")},t={callbackFunction:I,payload:i,url:Alloy.CFG.Urls.baseURL+Alloy.CFG.Urls.postReviewData+o.item_id};n.post(t)}else d.loadCustomDialog("Review",Alloy.CFG.Languages.offlineMessage)},w=function(){return""==e.txtReviewMessage.value?(s.validationFailAction(e.txtReviewMessage),changeFlag=0,!1):!0},I=function(){o.loadReview(o.item_id),v()},v=function(){r.endLoading(),d.loadCustomDialog("Review",Alloy.CFG.Languages.ReviewSubmitSuccessMessage),Ti.App.fireEvent("refreshGrid"),h()},p=function(){var i=g.getIcon("panacea","comment",35,{color:Alloy.CFG.Colors.IconColor});e.imgMessageReview.image=i;var t=g.getIcon("panacea","user",35,{color:Alloy.CFG.Colors.IconColor});e.imgUserNameReview.image=t;var o=g.getIcon("panacea","envelope",35,{color:Alloy.CFG.Colors.IconColor});e.imgEmailReview.image=o;var r=g.getIcon("panacea","back",35,{color:Alloy.CFG.Colors.IconWhite});e.imgBack.image=r},y=function(){e.lblReviewMessage.text=Alloy.CFG.Languages.lblReviewMessage,e.btnSubmit.text=Alloy.CFG.Languages.btnSubmit};e.review.addEventListener("open",function(){m()}),t["$.__views.mainTitle!click!closeWindow"]&&e.__views.mainTitle.addEventListener("click",h),t["$.__views.imgBack!click!closeWindow"]&&e.__views.imgBack.addEventListener("click",h),t["$.__views.btnSubmit!click!doReviewSubmit"]&&e.__views.btnSubmit.addEventListener("click",u),_.extend(e,i)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;