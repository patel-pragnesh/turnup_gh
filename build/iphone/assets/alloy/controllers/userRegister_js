function __processArg(e,i){var t=null;return e&&(t=e[i]||null,delete e[i]),t}function Controller(){require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="userRegister",arguments[0]&&(__processArg(arguments[0],"__parentSymbol"),__processArg(arguments[0],"$model"),__processArg(arguments[0],"__itemTemplate"));var e=this,i={},t={};e.__views.userRegister=Ti.UI.createWindow({backgroundColor:Alloy.CFG.Colors.BackgroundColor,opacity:1,width:Ti.UI.FILL,height:Ti.UI.FILL,layout:"vertical",navBarHidden:!0,id:"userRegister"}),e.__views.userRegister&&e.addTopLevelView(e.__views.userRegister),e.__views.__alloyId52=Ti.UI.createView({height:Ti.UI.SIZE,width:Ti.UI.FILL,backgroundColor:Alloy.CFG.Colors.MainColor,top:0,id:"__alloyId52"}),e.__views.userRegister.add(e.__views.__alloyId52),e.__views.AppWrapper=Ti.UI.createView({height:Ti.UI.SIZE,id:"AppWrapper"}),e.__views.__alloyId52.add(e.__views.AppWrapper),e.__views.mainTitle=Ti.UI.createLabel({font:{fontSize:20,fontFamily:"Jengle Jungallery"},height:44.4,color:"#FFF",left:"30",id:"mainTitle",text:"Register"}),e.__views.AppWrapper.add(e.__views.mainTitle),w?e.__views.mainTitle.addEventListener("click",w):t["$.__views.mainTitle!click!closeWindow"]=!0,e.__views.imgBack=Ti.UI.createImageView({left:5,width:30,height:30,right:5,id:"imgBack"}),e.__views.AppWrapper.add(e.__views.imgBack),w?e.__views.imgBack.addEventListener("click",w):t["$.__views.imgBack!click!closeWindow"]=!0,e.__views.registerView=Ti.UI.createScrollView({layout:"vertical",left:15,right:15,top:5,id:"registerView"}),e.__views.userRegister.add(e.__views.registerView),e.__views.__alloyId53=Ti.UI.createView({layout:"horizontal",width:Ti.UI.SIZE,height:Ti.UI.SIZE,top:5,left:"0",id:"__alloyId53"}),e.__views.registerView.add(e.__views.__alloyId53),e.__views.imgUserNameRegister=Ti.UI.createImageView({top:15,width:20,height:20,left:5,right:5,id:"imgUserNameRegister"}),e.__views.__alloyId53.add(e.__views.imgUserNameRegister),e.__views.lblUserName=Ti.UI.createLabel({font:{fontSize:19,fontFamily:"BodoniFLF",fontWeight:"bold"},height:Ti.UI.SIZE,textAlign:"left",text:"User Name",top:"13",color:"#464646",id:"lblUserName"}),e.__views.__alloyId53.add(e.__views.lblUserName),e.__views.txtUserName=Ti.UI.createTextField({top:5,width:"98%",left:"1%",right:"1%",backgroundColor:"#EEE",color:"#222",font:{fontFamily:"BodoniFLF"},borderWidth:1,borderColor:Alloy.CFG.Colors.MainColor,borderRadius:3,height:40,paddingLeft:5,paddingRight:5,id:"txtUserName",hintText:"User Name"}),e.__views.registerView.add(e.__views.txtUserName),e.__views.__alloyId54=Ti.UI.createView({layout:"horizontal",width:Ti.UI.SIZE,height:Ti.UI.SIZE,top:5,left:"0",id:"__alloyId54"}),e.__views.registerView.add(e.__views.__alloyId54),e.__views.imgEmailRegister=Ti.UI.createImageView({top:15,width:15,height:15,left:5,right:5,id:"imgEmailRegister"}),e.__views.__alloyId54.add(e.__views.imgEmailRegister),e.__views.lblEmail=Ti.UI.createLabel({font:{fontSize:19,fontFamily:"BodoniFLF",fontWeight:"bold"},height:Ti.UI.SIZE,textAlign:"left",text:"Email",top:"9",color:"#464646",id:"lblEmail"}),e.__views.__alloyId54.add(e.__views.lblEmail),e.__views.txtEmail=Ti.UI.createTextField({top:5,width:"98%",left:"1%",right:"1%",backgroundColor:"#EEE",color:"#222",font:{fontFamily:"BodoniFLF"},borderWidth:1,borderColor:Alloy.CFG.Colors.MainColor,borderRadius:3,height:40,paddingLeft:5,paddingRight:5,id:"txtEmail",hintText:"Email"}),e.__views.registerView.add(e.__views.txtEmail),e.__views.__alloyId55=Ti.UI.createView({layout:"horizontal",width:Ti.UI.SIZE,height:Ti.UI.SIZE,top:5,left:"0",id:"__alloyId55"}),e.__views.registerView.add(e.__views.__alloyId55),e.__views.imgPasswordRegister=Ti.UI.createImageView({top:15,width:20,height:20,left:5,right:5,id:"imgPasswordRegister"}),e.__views.__alloyId55.add(e.__views.imgPasswordRegister),e.__views.lblPassword=Ti.UI.createLabel({font:{fontSize:19,fontFamily:"BodoniFLF",fontWeight:"bold"},height:Ti.UI.SIZE,textAlign:"left",text:"Password",top:"13",color:"#464646",id:"lblPassword"}),e.__views.__alloyId55.add(e.__views.lblPassword),e.__views.txtPassword=Ti.UI.createTextField({top:5,width:"98%",left:"1%",right:"1%",backgroundColor:"#EEE",color:"#222",font:{fontFamily:"BodoniFLF"},borderWidth:1,borderColor:Alloy.CFG.Colors.MainColor,borderRadius:3,height:40,paddingLeft:5,paddingRight:5,id:"txtPassword",hintText:"Password",passwordMask:"true"}),e.__views.registerView.add(e.__views.txtPassword),e.__views.btnRegister=Ti.UI.createButton({font:{fontSize:18,fontFamily:"BodoniFLF"},height:33.3,top:20,bottom:10,width:"98%",left:"1%",right:"1%",backgroundColor:Alloy.CFG.Colors.MainColor,backgroundSelectedColor:Alloy.CFG.Colors.MainColor_Dark,borderColor:Alloy.CFG.Colors.MainPressedColor,color:Alloy.CFG.Colors.TextColor,backgroundImage:"null",selectedColor:"#AAA",id:"btnRegister",title:" Register "}),e.__views.registerView.add(e.__views.btnRegister),m?e.__views.btnRegister.addEventListener("click",m):t["$.__views.btnRegister!click!doUserRegister"]=!0,i.destroy=function(){},_.extend(e,e.__views);var o=arguments[0]||{},r=require("platformSupport"),l=require("animation"),a=require("icomoonlib"),s=require("loader"),n=require("validationRules");require("psdialog");var d=Alloy.Collections.users,g=0,c=require("loadingWindow");c.endLoading(),r.isiOS7Plus()&&(e.AppWrapper.top=20);var w=function(){l.out(e.userRegister)},m=function(){if(u()&&1==Titanium.Network.online){var i={username:e.txtUserName.value,email:e.txtEmail.value,password:e.txtPassword.value};c.startLoading();var t={callbackFunction:h,payload:i,url:Alloy.CFG.Urls.baseURL+Alloy.CFG.Urls.postUserRegister};s.post(t)}},u=function(){return""==e.txtEmail.value?(n.validationFailAction(e.txtEmail),g=0,!1):n.validateEmail(e.txtEmail.value)?""==e.txtPassword.value?(n.validationFailAction(e.txtPassword),g=0,!1):""==e.txtUserName.value?(n.validationFailAction(e.txtUserName),g=0,!1):!0:(n.validationFailAction(e.txtEmail),g=0,!1)},h=function(i){if(""!=i.user_id){Ti.App.fireEvent("refreshMenu");var t=Alloy.createModel("users",{id:i.user_id,username:e.txtUserName.value,email:e.txtEmail.value,about_me:"",is_banned:0,profile_photo:"",background_photo:""});if(d.add(t),t.save(),d.fetch(),Ti.App.Properties.setString("userId",i.user_id),w(),0==o.item_id)w();else{var r={item_id:o.item_id,loadReview:o.loadReview},a=Alloy.createController("review",r).getView();l.in(a)}c.endLoading()}};e.txtEmail.addEventListener("change",function(){0==g&&(n.backToNormal(e.txtEmail),g=1)}),e.txtPassword.addEventListener("change",function(){0==g&&(n.backToNormal(e.txtPassword),g=1)}),e.txtUserName.addEventListener("change",function(){0==g&&(n.backToNormal(e.txtUserName),g=1)});var v=function(){var i=a.getIcon("panacea","envelope",35,{color:Alloy.CFG.Colors.IconColor});e.imgEmailRegister.image=i;var t=a.getIcon("panacea","lock",35,{color:Alloy.CFG.Colors.IconColor});e.imgPasswordRegister.image=t;var o=a.getIcon("panacea","user",35,{color:Alloy.CFG.Colors.IconColor});e.imgUserNameRegister.image=o;var r=a.getIcon("panacea","back",35,{color:Alloy.CFG.Colors.IconWhite});e.imgBack.image=r},I=function(){e.lblUserName.text=Alloy.CFG.Languages.lblUserName,e.lblEmail.text=Alloy.CFG.Languages.lblEmail,e.lblPassword.text=Alloy.CFG.Languages.lblPassword,e.btnRegister.title=Alloy.CFG.Languages.btnRegister},p=function(){v(),I(),l.slowlyAppear(e.registerView)};e.userRegister.addEventListener("open",function(){c.endLoading(),p()}),t["$.__views.mainTitle!click!closeWindow"]&&e.__views.mainTitle.addEventListener("click",w),t["$.__views.imgBack!click!closeWindow"]&&e.__views.imgBack.addEventListener("click",w),t["$.__views.btnRegister!click!doUserRegister"]&&e.__views.btnRegister.addEventListener("click",m),_.extend(e,i)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;