function __processArg(e,i){var t=null;return e&&(t=e[i]||null,delete e[i]),t}function Controller(){require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="itemDetail",arguments[0]&&(__processArg(arguments[0],"__parentSymbol"),__processArg(arguments[0],"$model"),__processArg(arguments[0],"__itemTemplate"));var e=this,i={},t={};e.__views.itemDetail=Ti.UI.createWindow({navBarHidden:"true",id:"itemDetail"}),e.__views.itemDetail&&e.addTopLevelView(e.__views.itemDetail),e.__views.__alloyId13=Ti.UI.createView({backgroundColor:Alloy.CFG.Colors.BackgroundColor,opacity:1,width:Ti.UI.FILL,height:Ti.UI.FILL,layout:"vertical",navBarHidden:!0,id:"__alloyId13"}),e.__views.itemDetail.add(e.__views.__alloyId13),e.__views.__alloyId14=Ti.UI.createView({height:Ti.UI.SIZE,width:Ti.UI.FILL,backgroundColor:Alloy.CFG.Colors.MainColor,top:0,id:"__alloyId14"}),e.__views.__alloyId13.add(e.__views.__alloyId14),e.__views.AppWrapper=Ti.UI.createView({height:Ti.UI.SIZE,id:"AppWrapper"}),e.__views.__alloyId14.add(e.__views.AppWrapper),e.__views.mainTitle=Ti.UI.createLabel({font:{fontSize:20,fontFamily:"Jengle Jungallery"},height:44.4,color:"#FFF",left:"30",id:"mainTitle",text:""}),e.__views.AppWrapper.add(e.__views.mainTitle),g?e.__views.mainTitle.addEventListener("click",g):t["$.__views.mainTitle!click!closeWindow"]=!0,e.__views.imgBack=Ti.UI.createImageView({width:30,height:30,left:0,right:6,id:"imgBack"}),e.__views.AppWrapper.add(e.__views.imgBack),g?e.__views.imgBack.addEventListener("click",g):t["$.__views.imgBack!click!closeWindow"]=!0,e.__views.FavouriteView=Ti.UI.createView({width:40,height:40,right:3,id:"FavouriteView",visible:"true"}),e.__views.AppWrapper.add(e.__views.FavouriteView),y?e.__views.FavouriteView.addEventListener("click",y):t["$.__views.FavouriteView!click!doFavourite"]=!0,e.__views.imgFavourite=Ti.UI.createImageView({width:20,height:20,left:6,right:6,id:"imgFavourite"}),e.__views.FavouriteView.add(e.__views.imgFavourite),e.__views.midContainer=Ti.UI.createScrollView({layout:"vertical",height:Ti.UI.FILL,width:Ti.UI.SIZE,id:"midContainer"}),e.__views.__alloyId13.add(e.__views.midContainer),e.__views.productImgView=Ti.UI.createView({width:Ti.UI.SIZE,height:"300",borderWidth:"0",id:"productImgView"}),e.__views.midContainer.add(e.__views.productImgView),e.__views.imProductImage=Ti.UI.createImageView({id:"imProductImage"}),e.__views.productImgView.add(e.__views.imProductImage),h?e.__views.imProductImage.addEventListener("click",h):t["$.__views.imProductImage!click!openSlider"]=!0,e.__views.__alloyId15=Ti.UI.createView({layout:"vertical",width:Ti.UI.FILL,height:Ti.UI.SIZE,backgroundColor:"white",id:"__alloyId15"}),e.__views.midContainer.add(e.__views.__alloyId15),e.__views.thumbContainerView=Ti.UI.createView({layout:"horizontal",width:Ti.UI.SIZE,top:10,id:"thumbContainerView",borderWidth:"0",height:"55"}),e.__views.__alloyId15.add(e.__views.thumbContainerView),e.__views.imgLeft=Ti.UI.createImageView({width:20,height:20,left:6,right:6,id:"imgLeft",image:"/images/backward.png"}),e.__views.thumbContainerView.add(e.__views.imgLeft),I?e.__views.imgLeft.addEventListener("click",I):t["$.__views.imgLeft!click!gotoLeftMost"]=!0,e.__views.thumbImagesScrollView=Ti.UI.createScrollView({layout:"horizontal",width:Ti.UI.FILL,showHorizontalScrollIndicator:!0,showVerticalScrollIndicator:!1,scrollType:"horizontal",contentWidth:1250,id:"thumbImagesScrollView",borderWidth:"0"}),e.__views.thumbContainerView.add(e.__views.thumbImagesScrollView),e.__views.imgRight=Ti.UI.createImageView({width:20,height:20,left:6,right:6,id:"imgRight",image:"/images/forward.png"}),e.__views.thumbContainerView.add(e.__views.imgRight),w?e.__views.imgRight.addEventListener("click",w):t["$.__views.imgRight!click!gotoRightMost"]=!0,e.__views.infoContainer=Ti.UI.createView({layout:"vertical",width:Ti.UI.FILL,height:Ti.UI.SIZE,id:"infoContainer"}),e.__views.__alloyId15.add(e.__views.infoContainer),e.__views.lblTitle=Ti.UI.createLabel({font:{fontSize:19,fontFamily:"BodoniFLF",fontWeight:"bold"},height:Ti.UI.SIZE,textAlign:"left",width:Ti.UI.FILL,top:10,text:"",id:"lblTitle",color:"#464646"}),e.__views.infoContainer.add(e.__views.lblTitle),e.__views.socialView=Ti.UI.createView({layout:"horizontal",width:Ti.UI.FILL,height:Ti.UI.SIZE,left:0,bottom:"-3",id:"socialView"}),e.__views.infoContainer.add(e.__views.socialView),e.__views.iconBackground=Ti.UI.createView({height:30,width:Ti.UI.FILL,id:"iconBackground",layout:"horizontal"}),e.__views.socialView.add(e.__views.iconBackground),e.__views.imgLike=Ti.UI.createImageView({width:20,height:20,left:6,right:6,id:"imgLike"}),e.__views.iconBackground.add(e.__views.imgLike),v?e.__views.imgLike.addEventListener("click",v):t["$.__views.imgLike!click!doLike"]=!0,e.__views.likeCount=Ti.UI.createLabel({font:{fontSize:18,fontFamily:"BodoniFLF"},height:Ti.UI.SIZE,left:0,text:"0",id:"likeCount",color:"#464646"}),e.__views.iconBackground.add(e.__views.likeCount),v?e.__views.likeCount.addEventListener("click",v):t["$.__views.likeCount!click!doLike"]=!0,e.__views.FavouriteView1=Ti.UI.createView({width:40,height:40,right:8,id:"FavouriteView1",visible:"true"}),e.__views.socialView.add(e.__views.FavouriteView1),e.__views.imgCapture=Ti.UI.createImageView({width:30,height:30,left:6,right:6,id:"imgCapture"}),e.__views.FavouriteView1.add(e.__views.imgCapture),e.__views.__alloyId16=Ti.UI.createImageView({width:Ti.UI.FILL,height:.7,image:"/images/strikeDDD.png",top:5,bottom:10,id:"__alloyId16"}),e.__views.infoContainer.add(e.__views.__alloyId16),e.__views.lblDescription=Ti.UI.createLabel({font:{fontSize:18,fontFamily:"BodoniFLF"},height:Ti.UI.SIZE,textAlign:"left",width:Ti.UI.FILL,text:"",id:"lblDescription",color:"#464646"}),e.__views.infoContainer.add(e.__views.lblDescription),e.__views.phoneView=Ti.UI.createView({layout:"horizontal",width:Ti.UI.SIZE,height:Ti.UI.SIZE,top:10,left:"0",id:"phoneView"}),e.__views.infoContainer.add(e.__views.phoneView),e.__views.imgPhone=Ti.UI.createImageView({width:20,height:20,left:0,right:6,id:"imgPhone"}),e.__views.phoneView.add(e.__views.imgPhone),e.__views.lblPhoneNo=Ti.UI.createLabel({font:{fontSize:18,fontFamily:"BodoniFLF"},height:Ti.UI.SIZE,textAlign:"left",width:Ti.UI.FILL,text:"Phone No",color:"#464646",id:"lblPhoneNo"}),e.__views.phoneView.add(e.__views.lblPhoneNo),e.__views.locationView=Ti.UI.createView({layout:"horizontal",width:Ti.UI.SIZE,height:Ti.UI.SIZE,top:10,left:"0",id:"locationView"}),e.__views.infoContainer.add(e.__views.locationView),e.__views.imgLocation=Ti.UI.createImageView({width:20,height:20,left:0,right:6,id:"imgLocation"}),e.__views.locationView.add(e.__views.imgLocation),e.__views.lblLocation=Ti.UI.createLabel({font:{fontSize:18,fontFamily:"BodoniFLF"},height:Ti.UI.SIZE,textAlign:"left",width:Ti.UI.FILL,text:"Location",color:"#464646",id:"lblLocation"}),e.__views.locationView.add(e.__views.lblLocation),e.__views.strike2=Ti.UI.createImageView({width:Ti.UI.FILL,height:.7,image:"/images/strikeDDD.png",top:10,bottom:10,id:"strike2"}),e.__views.infoContainer.add(e.__views.strike2),e.__views.__alloyId17=Ti.UI.createView({width:Ti.UI.FILL,height:Ti.UI.SIZE,id:"__alloyId17"}),e.__views.infoContainer.add(e.__views.__alloyId17),e.__views.writeItemReview=Ti.UI.createView({layout:"horizontal",width:Ti.UI.SIZE,height:Ti.UI.SIZE,right:0,id:"writeItemReview"}),e.__views.__alloyId17.add(e.__views.writeItemReview),u?e.__views.writeItemReview.addEventListener("click",u):t["$.__views.writeItemReview!click!openReview"]=!0,e.__views.lblWriteReview=Ti.UI.createLabel({font:{fontSize:16,fontFamily:"BodoniFLF"},height:Ti.UI.SIZE,textAlign:"right",width:Ti.UI.SIZE,text:"Write Review",id:"lblWriteReview",color:"#454545"}),e.__views.writeItemReview.add(e.__views.lblWriteReview),e.__views.imgWriteReviewIcon=Ti.UI.createImageView({width:25,height:25,left:6,right:6,id:"imgWriteReviewIcon"}),e.__views.writeItemReview.add(e.__views.imgWriteReviewIcon),e.__views.reviewView=Ti.UI.createView({layout:"vertical",width:Ti.UI.FILL,height:Ti.UI.SIZE,bottom:25,id:"reviewView"}),e.__views.infoContainer.add(e.__views.reviewView),i.destroy=function(){},_.extend(e,e.__views);var o=arguments[0]||{},r=require("platformSupport"),a=require("animation"),n=require("icomoonlib"),s=require("loader"),l=require("psdialog"),d=require("loadingWindow");r.isiOS7Plus()&&(e.AppWrapper.top=20);var c=function(e){var i={callbackFunction:p,url:Alloy.CFG.Urls.baseURL+Alloy.CFG.Urls.getItemDetailById+e};s.get(i)},h=function(){var e=Alloy.createController("slider",o).getView();a.in(e)},g=function(){a.out(e.itemDetail)},u=function(){d.startLoading();var e=Ti.App.Properties.getString("userId"),i={item_id:o.item.id,loadReview:c};if(e){var t=Alloy.createController("review",i).getView();a.in(t)}else{var t=Alloy.createController("userLogin",i).getView();a.in(t)}},m=function(){var i="",t=r.getScreenWidth(),a=r.getScreenHeight(),n=[];n.width=o.item.images[0].width,n.height=o.item.images[0].height;var s=r.getGridPhotoSizeCalWidth(n,t);d.endLoading(),e.imProductImage.image=Alloy.CFG.Urls.imagePathURL+o.item.images[0].path,e.imProductImage.width=s.width,e.imProductImage.height=s.height,e.productImgView.height=a/2.2,e.lblTitle.text=o.item.name,e.lblDescription.text=o.item.description,e.likeCount.text=o.item.like_count,""==o.item.phone?(e.phoneView.opacity=0,e.phoneView.height=0):(e.phoneView.opacity=1,e.phoneView.height=Ti.UI.SIZE,e.lblPhoneNo.text=o.item.phone),""==o.item.address?(e.locationView.opacity=0,e.locationView.height=0):(e.locationView.opacity=1,e.locationView.height=Ti.UI.SIZE,e.lblLocation.text=o.item.address);for(var l=0;l<o.item.images.length;l++){if(0==l)var _={imagePath:Alloy.CFG.Urls.imagePathURL+o.item.images[l].path,thumbId:l,width:o.item.images[l].width,height:o.item.images[l].height,selected:!0,loadSelctedItemImageFunction:"loadSlectedItemImage"};else var _={imagePath:Alloy.CFG.Urls.imagePathURL+o.item.images[l].path,thumbId:l,width:o.item.images[l].width,height:o.item.images[l].height,selected:!1,loadSelctedItemImageFunction:"loadSlectedItemImage"};contentView=Alloy.createController("thumbImages",_).getView(),e.thumbImagesScrollView.add(contentView)}e.thumbImagesScrollView.contentWidth=parseInt(55*o.item.images.length)+30,e.thumbImagesScrollView.width=r.getScreenWidth()-70,Alloy.isTablet?(e.thumbImagesScrollView.width=400,e.thumbContainerView.left=parseInt(parseInt(r.getScreenWidth())-e.thumbContainerView.width)/2,i=50,e.lblTitle.top=10,r.setNormalFontForTablet(e.lblDescription,16)):i=20,e.midContainer.applyProperties({width:t,contentWidth:t}),e.infoContainer.applyProperties({left:i,right:i}),L(),A(),c(o.item.id),C(),E(),b(),k()};Ti.App.addEventListener("loadSlectedItemImage",function(){var i=Ti.App.Properties.getString("selectedThumbImageIndex"),t=r.getScreenWidth(),a=r.getScreenHeight(),n=[];try{n.width=o.item.images[i].width,n.height=o.item.images[i].height}catch(s){}var l=r.getGridPhotoSizeCalWidth(n,t);try{e.imProductImage.image=Alloy.CFG.Urls.imagePathURL+o.item.images[i].path,n.width=o.item.images[i].width,n.height=o.item.images[i].height}catch(s){}e.imProductImage.width=l.width,e.imProductImage.height=l.height,e.productImgView.height=a/2.2,e.thumbImagesScrollView.removeAllChildren();for(var d=0;d<o.item.images.length;d++){if(d==i)var c={imagePath:Alloy.CFG.Urls.imagePathURL+o.item.images[d].path,thumbId:d,width:o.item.images[d].width,height:o.item.images[d].height,selected:!0,loadSelctedItemImageFunction:"loadSlectedItemImage"};else var c={imagePath:Alloy.CFG.Urls.imagePathURL+o.item.images[d].path,thumbId:d,width:o.item.images[d].width,height:o.item.images[d].height,selected:!1,loadSelctedItemImageFunction:"loadSlectedItemImage"};contentView=Alloy.createController("thumbImages",c).getView(),e.thumbImagesScrollView.add(contentView)}});var w=function(){e.thumbImagesScrollView.scrollToBottom()},I=function(){e.thumbImagesScrollView.scrollTo(0,0)},p=function(i){if(i.reviews){var t=i.reviews,o=t.length,r=null;e.reviewView.removeAllChildren();for(var a=0;o>a;a++)r=Alloy.createController("reviewRow",t[a]).getView(),e.reviewView.add(r)}},v=function(){if(1==Titanium.Network.online)if(Ti.App.Properties.getString("userId"),Ti.App.Properties.getString("userId")){var e={appuser_id:Ti.App.Properties.getString("userId")},i={callbackFunction:f,payload:e,url:Alloy.CFG.Urls.baseURL+Alloy.CFG.Urls.postLikeData+o.item.id};s.post(i)}else{var t={item_id:0};Alloy.createController("userLogin",t).getView(),l.loadCustomDialog("Like",Alloy.CFG.Languages.needForLoginMesssage)}else l.loadCustomDialog("Like",Alloy.CFG.Languages.offlineMessage)},f=function(i){e.imgLike.animate({width:45,height:45,duration:100},function(){e.imgLike.animate({width:25,height:25,duration:100},function(){e.imgLike.width=20,e.imgLike.height=20,myicon=n.getIcon("panacea","thumbs-up",35,{color:Alloy.CFG.Colors.ItemIconColor_Dark}),e.imgLike.image=myicon,i.success?(e.likeCount.text=i.total,Ti.App.fireEvent("refreshGrid")):l.loadCustomDialog("Like",Alloy.CFG.Languages.alreadyLikeMessage)})}),Ti.API.info(JSON.stringify(i))},y=function(){if(1==Titanium.Network.online)if(Ti.App.Properties.getString("userId"),Ti.App.Properties.getString("userId")){var e={appuser_id:Ti.App.Properties.getString("userId")},i={callbackFunction:T,payload:e,url:Alloy.CFG.Urls.baseURL+Alloy.CFG.Urls.postFavouriteData+o.item.id};s.post(i)}else{var t={item_id:0};Alloy.createController("userLogin",t).getView(),l.loadCustomDialog("Favourite",Alloy.CFG.Languages.needForFavouriteMesssage)}else l.loadCustomDialog("Favourite",Alloy.CFG.Languages.offlineMessage)},T=function(i){e.imgFavourite.animate({width:40,height:40,duration:100},function(){e.imgFavourite.animate({width:25,height:25,duration:100},function(){e.imgFavourite.width=20,e.imgFavourite.height=20;var t=n.getIcon("panacea","star",35,{color:Alloy.CFG.Colors.MainColor_Dark});e.imgFavourite.image=t,i.success||l.loadCustomDialog("Favourite",Alloy.CFG.Languages.alreadyFavouriteMessage)})})},L=function(){var i=n.getIcon("panacea","thumbs-up",35,{color:Alloy.CFG.Colors.ItemIconColor});e.imgLike.image=i,n.getIcon("panacea","thumbs-down",35,{color:Alloy.CFG.Colors.ItemIconColor}),n.getIcon("panacea","comment",35,{color:Alloy.CFG.Colors.ItemIconColor});var t=n.getIcon("panacea","phone-square-pin",35,{color:Alloy.CFG.Colors.ItemIconColor});e.imgPhone.image=t;var o=n.getIcon("panacea","address-square-pin",35,{color:Alloy.CFG.Colors.ItemIconColor});e.imgLocation.image=o;var r=n.getIcon("panacea","pencil-square",35,{color:Alloy.CFG.Colors.IconColor});e.imgWriteReviewIcon.image=r;var a=n.getIcon("panacea","back",35,{color:Alloy.CFG.Colors.IconWhite});e.imgBack.image=a;var s=n.getIcon("panacea","star",35,{color:Alloy.CFG.Colors.CatIconColor});e.imgFavourite.image=s;var l=n.getIcon("panacea","camera",35,{color:Alloy.CFG.Colors.CatIconColor});e.imgCapture.image=l},A=function(){e.lblWriteReview.text=Alloy.CFG.Languages.lblWriteReview},C=function(){if(1==Titanium.Network.online){var e={appuser_id:Ti.App.Properties.getString("userId")},i={callbackFunction:S,payload:e,url:Alloy.CFG.Urls.baseURL+Alloy.CFG.Urls.postIsLiked+o.item.id};s.post(i)}},S=function(i){"yes"==i.status&&(myicon=n.getIcon("panacea","thumbs-up",35,{color:Alloy.CFG.Colors.ItemIconColor_Dark}),e.imgLike.image=myicon,e.likeCount.text=i.total)},E=function(){if(1==Titanium.Network.online){var e={appuser_id:Ti.App.Properties.getString("userId")},i={callbackFunction:F,payload:e,url:Alloy.CFG.Urls.baseURL+Alloy.CFG.Urls.postIsUnLiked+o.item.id};s.post(i)}},F=function(e){"yes"==e.status&&(myicon=n.getIcon("panacea","thumbs-down",35,{color:Alloy.CFG.Colors.ItemIconColor_Dark}))},b=function(){if(1==Titanium.Network.online){var e={appuser_id:Ti.App.Properties.getString("userId")},i={callbackFunction:U,payload:e,url:Alloy.CFG.Urls.baseURL+Alloy.CFG.Urls.postIsFavourited+o.item.id};s.post(i)}},U=function(i){"yes"==i.status&&(myicon=n.getIcon("panacea","star",35,{color:Alloy.CFG.Colors.MainColor_Dark}),e.imgFavourite.image=myicon)},k=function(){if(null!=Ti.App.Properties.getString("userId"))var e={appuser_id:Ti.App.Properties.getString("userId")};else var e={appuser_id:0};var i={callbackFunction:P,url:Alloy.CFG.Urls.baseURL+Alloy.CFG.Urls.postTouchData+o.item.id,payload:e};s.post(i)},P=function(e){console.log(e.success?"Touch Count Successfully Increased.":"Gor Error when insert touch count.")};e.itemDetail.addEventListener("open",function(){d.endLoading(),m()});var V=Titanium.UI.createAlertDialog({title:"Photo Upload",message:"We are uploading your photo...Please wait.",buttonNames:["Dismiss"]});e.imgCapture.addEventListener("click",function(){Ti.Media.showCamera({showControls:!0,mediaTypes:Ti.Media.MEDIA_TYPE_PHOTO,autohide:!0,allowEditing:!0,success:function(e){Ti.API.info("success! event: "+JSON.stringify(e));var i=e.media;Ti.API.info(i.height+" x "+i.width);var t=Titanium.UI.createImageView({image:i,width:375,height:500});i=t.toImage(),Ti.API.info(i.height+" x "+i.width),V.show();var r=Titanium.Network.createHTTPClient();r.onerror=function(e){Ti.API.info("IN ERROR "+e.error)},r.onload=function(){Ti.API.info("IN ONLOAD "+this.status+" readyState "+this.readyState),setTimeout(function(){m()},1e4)},r.onsendstream=function(e){Ti.API.info("ONSENDSTREAM - PROGRESS: "+e.progress+" "+this.status+" "+this.readyState)},r.open("POST","http://nkdproductions.com/turnup/app/cameraupload.php"),r.setRequestHeader("Connection","close");var a={item_id:o.item.id,type:"item",width:"475",height:"316",media:i};r.send(a)},cancel:function(){},error:function(){}}),V.close()}),t["$.__views.mainTitle!click!closeWindow"]&&e.__views.mainTitle.addEventListener("click",g),t["$.__views.imgBack!click!closeWindow"]&&e.__views.imgBack.addEventListener("click",g),t["$.__views.FavouriteView!click!doFavourite"]&&e.__views.FavouriteView.addEventListener("click",y),t["$.__views.imProductImage!click!openSlider"]&&e.__views.imProductImage.addEventListener("click",h),t["$.__views.imgLeft!click!gotoLeftMost"]&&e.__views.imgLeft.addEventListener("click",I),t["$.__views.imgRight!click!gotoRightMost"]&&e.__views.imgRight.addEventListener("click",w),t["$.__views.imgLike!click!doLike"]&&e.__views.imgLike.addEventListener("click",v),t["$.__views.likeCount!click!doLike"]&&e.__views.likeCount.addEventListener("click",v),t["$.__views.writeItemReview!click!openReview"]&&e.__views.writeItemReview.addEventListener("click",u),_.extend(e,i)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;